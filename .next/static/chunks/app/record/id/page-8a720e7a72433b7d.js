(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98],{5695:(e,s,t)=>{"use strict";var a=t(8999);t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},7428:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});var a=t(5155);function r(){return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-white",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-gray-200 border-t-blue-600 rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("div",{className:"text-gray-600 font-medium",children:"Cargando..."})]})})}},8218:(e,s,t)=>{"use strict";t.d(s,{default:()=>n});var a=t(5155),r=t(2115),l=t(5695),c=t(7428);function n(){let e=(0,l.useSearchParams)(),s=e.get("orderId"),t=e.get("userId"),[n,d]=(0,r.useState)(null),[i,o]=(0,r.useState)(!0),[m,x]=(0,r.useState)(null),[h,u]=(0,r.useState)("USD"),p=(0,l.useRouter)();(0,r.useEffect)(()=>{let e=async()=>{try{if(console.log(s),console.log(t),!s||!t)throw Error(s?"Usuario no autenticado":"Pedido no encontrado");let e=await fetch("".concat("https://app.fadiar.com/api","/getOrder"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_user_action:t,id_order:parseInt(s,10)})});if(!e.ok)throw Error("Error al obtener detalles");let a=await e.json();console.log("Datos de la orden"),console.log(a),d(a)}catch(e){x(e instanceof Error?e.message:"Error desconocido")}finally{o(!1)}};(async()=>{try{let e=await fetch("https://app.fadiar.com/api/get_location",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});await e.json(),u("USD")}catch(e){console.error("Error detecting country:",e),u("CUP")}})(),e()},[]);let j=(e,s)=>{let t=e.find(e=>e[2]===s);return t?t[1]:null};return i?(0,a.jsx)(c.A,{}):m?(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center text-red-500",children:[(0,a.jsxs)("p",{children:["Error: ",m]}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-[#022953] text-white rounded hover:bg-blue-700",children:"Reintentar"})]}):n?(0,a.jsx)("section",{className:"min-h-screen bg-gray-50 py-8",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 max-w-4xl",children:[(0,a.jsxs)("button",{onClick:()=>p.back(),className:"mb-6 flex items-center text-[#022953] hover:text-blue-700",children:[(0,a.jsx)("span",{className:"mr-2",children:"←"}),"Volver a pedidos"]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start mb-6",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-[#022953] mb-4 md:mb-0",children:["Pedido #",n.id]}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full ".concat((e=>{switch(e){case -1:return"bg-red-500 text-white";case 0:return"bg-blue-100 text-blue-800";case 1:return"bg-green-500 text-white";default:return"bg-gray-100 text-gray-800"}})(n.state)),children:-1===n.state?"Cancelada":1===n.state?"Aceptado":"En espera"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-semibold text-[#022953] mb-2",children:"Informaci\xf3n del Cliente"}),(0,a.jsxs)("p",{children:[n.client_name," ",n.client_last_names]}),(0,a.jsxs)("p",{children:["CI: ",String(n.client_ci).padStart(11,"0")]}),(0,a.jsxs)("p",{children:["Tel\xe9fono: ",n.client_cell]})]}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-semibold text-[#022953] mb-2",children:"Ubicaci\xf3n"}),(0,a.jsx)("p",{children:n.direccionExacta}),(0,a.jsxs)("p",{children:[n.municipio,", ",n.provincia]})]})]}),(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-semibold text-[#022953] mb-2",children:"Detalles del Pedido"}),(0,a.jsxs)("p",{children:["Fecha: ",new Date(n.date).toLocaleDateString()]}),(0,a.jsxs)("p",{children:["Hora: ",new Date(n.date).toLocaleTimeString()]}),n.acepted_date&&(0,a.jsxs)("p",{children:["Aceptado: ",new Date(n.acepted_date).toLocaleString()]})]})})]}),(0,a.jsxs)("div",{className:"border-t pt-6 border-[#022953]",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-[#022953] mb-6",children:"Productos"}),(0,a.jsx)("div",{className:"space-y-6",children:n.products.map((e,s)=>{let t=j(e.prices,h),r="".concat("https://app.fadiar.com/api","/").concat(e.img);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"relative w-full sm:w-32 h-32 flex-shrink-0",children:(0,a.jsx)("img",{src:r,alt:e.name,className:"object-contain rounded-lg w-full h-full",onError:e=>{e.target.src="/placeholder-product.jpg"}})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:e.name}),(0,a.jsxs)("p",{className:"text-gray-600 text-sm",children:[e.brand," ",e.model]}),(0,a.jsx)("p",{className:"text-sm mt-2",children:e.description}),(0,a.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Precio unitario:"}),(0,a.jsx)("p",{className:"font-medium truncate",children:t?"".concat(t.toFixed(2)," ").concat(h):"N/A"})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Cantidad:"}),(0,a.jsx)("p",{className:"font-medium",children:e.count})]})]}),(0,a.jsx)("div",{className:"mt-4 p-3 bg-white rounded border border-[#022953]",children:(0,a.jsxs)("p",{className:"text-sm font-medium",children:["Total producto:"," ",t?(t*e.count).toFixed(2):"N/A"," ",h]})})]})]}),s<n.products.length-1&&(0,a.jsx)("hr",{className:"my-6 border-t border-[#022953]"})]},e.id)})}),(0,a.jsx)("div",{className:"mt-8 p-4 bg-[#022953] text-white rounded-lg",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-lg font-semibold",children:"Total del pedido:"}),(0,a.jsxs)("span",{className:"text-xl font-bold",children:[(n?n.products.reduce((e,s)=>{let t=j(s.prices,h);return e+(t?t*s.count:0)},0):0).toFixed(2)," ",h]})]})})]})]}),n.chat.messages.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-[#022953] mb-6",children:"Notas"}),(0,a.jsx)("div",{className:"space-y-4",children:n.chat.messages.map(e=>(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium text-[#022953]",children:[e.name," ",e.lastname1]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.type})]}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.date).toLocaleString()})]}),(0,a.jsx)("p",{className:"text-gray-800 whitespace-pre-wrap",children:e.message})]},e.id))})]})]})}):(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center text-gray-500",children:[(0,a.jsx)("p",{children:"No se encontr\xf3 el pedido"}),(0,a.jsx)("button",{onClick:()=>p.back(),className:"mt-4 px-4 py-2 bg-[#022953] text-white rounded hover:bg-blue-700",children:"Volver"})]})}},8219:(e,s,t)=>{Promise.resolve().then(t.bind(t,8218))}},e=>{var s=s=>e(e.s=s);e.O(0,[441,684,358],()=>s(8219)),_N_E=e.O()}]);