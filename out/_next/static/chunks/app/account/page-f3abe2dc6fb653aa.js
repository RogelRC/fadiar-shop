(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[298],{5695:(e,a,i)=>{"use strict";var r=i(8999);i.o(r,"usePathname")&&i.d(a,{usePathname:function(){return r.usePathname}}),i.o(r,"useRouter")&&i.d(a,{useRouter:function(){return r.useRouter}}),i.o(r,"useSearchParams")&&i.d(a,{useSearchParams:function(){return r.useSearchParams}})},7709:(e,a,i)=>{Promise.resolve().then(i.bind(i,9020))},9020:(e,a,i)=>{"use strict";i.r(a),i.d(a,{default:()=>u});var r=i(5155),t=i(2115),s=i(5695),n=i(760),o=i(1471),l=i(9509);let c={hidden:{opacity:0,y:-20},visible:{opacity:1,y:0},exit:{opacity:0,y:20}},d=e=>{let{show:a}=e;return(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}):(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"})})};function u(){let[e,a]=(0,t.useState)(null),[i,u]=(0,t.useState)(!1),[m,x]=(0,t.useState)(""),[h,p]=(0,t.useState)(""),[g,b]=(0,t.useState)(""),[j,y]=(0,t.useState)(!1),[v,f]=(0,t.useState)(!1),[N,C]=(0,t.useState)(!1),[S,w]=(0,t.useState)(""),[M,k]=(0,t.useState)([]),[P,L]=(0,t.useState)(!0),[E,A]=(0,t.useState)(!1),[z,B]=(0,t.useState)(null),G={"Pinar del R\xedo":["Pinar del R\xedo","Consolaci\xf3n del Sur","Guane","La Palma","Los Palacios","Mantua","Minas de Matahambre","San Juan y Mart\xednez","San Luis","Sandino","Vi\xf1ales"],Artemisa:["Artemisa","Alqu\xedzar","Bauta","Caimito","Guanajay","G\xfcira de Melena","Mariel","San Antonio de los Ba\xf1os","Bah\xeda Honda","Candelaria","San Crist\xf3bal"],"La Habana":["Arroyo Naranjo","Boyeros","Centro Habana","Cerro","Cotorro","Diez de Octubre","Guanabacoa","Habana del Este","Habana Vieja","La Lisa","Marianao","Playa","Plaza de la Revoluci\xf3n","Regla","San Miguel del Padr\xf3n"],Mayabeque:["Bataban\xf3","Bejucal","G\xfcines","Jaruco","Madruga","Melena del Sur","Nueva Paz","Quivic\xe1n","San Jos\xe9 de las Lajas","Santa Cruz del Norte"],Matanzas:["C\xe1rdenas","Ci\xe9naga de Zapata","Col\xf3n","Jag\xfcey Grande","Jovellanos","Limonar","Los Arabos","Mart\xed","Matanzas","Pedro Betancourt","Perico","Uni\xf3n de Reyes"],Cienfuegos:["Aguada de Pasajeros","Cienfuegos","Cruces","Cumanayagua","Lajas","Palmira","Rodas"],"Villa Clara":["Caibari\xe9n","Camajuan\xed","Cifuentes","Corralillo","Encrucijada","Manicaragua","Placetas","Quemado de G\xfcines","Ranchuelo","Remedios","Sagua la Grande","Santa Clara","Santo Domingo"],"Sancti Sp\xedritus":["Cabaigu\xe1n","Fomento","Jatibonico","La Sierpe","Sancti Sp\xedritus","Taguasco","Trinidad","Yaguajay"],"Ciego de \xc1vila":["Baragu\xe1","Bolivia","Ciego de \xc1vila","Chambas","Ciro Redondo","Florencia","Majagua","Mor\xf3n","Primero de Enero","Venezuela"],Camagüey:["Camag\xfcey","Carlos Manuel de C\xe9spedes","Esmeralda","Florida","Guaimaro","Jimaguay\xfa","Minas","Najasa","Nuevitas","Santa Cruz del Sur","Sibanic\xfa","Sierra de Cubitas","Vertientes"],"Las Tunas":["Amancio","Colombia","Jes\xfas Men\xe9ndez","Jobabo","Las Tunas","Majibacoa","Manat\xed","Puerto Padre"],Holguín:["Antilla","B\xe1guanos","Banes","Cacocum","Calixto Garc\xeda","Cueto","Frank Pa\xeds","Gibara","Holgu\xedn","Mayar\xed","Moa","Rafael Freyre","Sagua de T\xe1namo","Urbano Noris"],Granma:["Bartolom\xe9 Mas\xf3","Bayamo","Buey Arriba","Campechuela","Cauto Cristo","Guisa","Jiguan\xed","Manzanillo","Media Luna","Niquero","Pil\xf3n","R\xedo Cauto","Yara"],"Santiago de Cuba":["Contramaestre","Guam\xe1","Mella","Palma Soriano","San Luis","Santiago de Cuba","Segundo Frente","Songo - La Maya","Tercer Frente"],Guantánamo:["Baracoa","Caimanera","El Salvador","Guant\xe1namo","Im\xedas","Mais\xed","Manuel Tames","Niceto P\xe9rez","San Antonio del Sur","Yateras"]},[J,T]=(0,t.useState)({provincia:"",municipio:"",direccion:""}),[D,O]=(0,t.useState)([]),[R,_]=(0,t.useState)(""),I=(0,s.useRouter)();(0,t.useEffect)(()=>{let e=localStorage.getItem("userData");if(!e){I.push("/login");return}try{let i=JSON.parse(e);a(i),F()}catch(e){console.error("Error parsing user data:",e),I.push("/login")}},[I]);let F=async()=>{try{let e=localStorage.getItem("userData");if(!e){I.push("/login");return}let a=JSON.parse(e),i=await fetch("".concat("https://app.fadiar.com/api","/obtener-direccion-domicilio-cliente"),{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id_user:a.userId})});if(i.ok){let e=await i.json();k(Array.isArray(null==e?void 0:e.listado)?e.listado:[])}}catch(e){console.error("Error fetching addresses:",e)}finally{L(!1)}},q=e=>{let{name:a,value:i}=e.target;"provincia"===a?(O(i&&G[i]||[]),T(e=>({...e,provincia:i,municipio:""}))):T(e=>({...e,[a]:i}))},H=async e=>{if(e.preventDefault(),_(""),!J.provincia||!J.municipio||!J.direccion){_("Todos los campos son obligatorios");return}try{let e=localStorage.getItem("userData");if(!e){I.push("/login");return}let a=JSON.parse(e),i=z?"editar-direccion-domicilio-cliente":"crear-direccion-domicilio-cliente",r={id_user:a.userId,provincia:J.provincia,municipio:J.municipio,direccion:J.direccion};if(z&&(r.id_direccion=z.id),console.log(r),!(await fetch("".concat("https://app.fadiar.com/api","/").concat(i),{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(r)})).ok)throw Error("Error al guardar la direcci\xf3n");await F(),T({provincia:"",municipio:"",direccion:""}),A(!1),B(null)}catch(e){_(e instanceof Error?e.message:"Error al guardar la direcci\xf3n")}},V=e=>{B(e);let a=String(e.provincia);T({provincia:a,municipio:String(e.municipio),direccion:String(e.direccion)}),a&&G[a]&&O(G[a]),A(!0)},U=async e=>{if(confirm("\xbfEst\xe1s seguro de que deseas eliminar esta direcci\xf3n?"))try{let a=localStorage.getItem("userData");if(!a){I.push("/login");return}let i=JSON.parse(a);if(console.log(e),!(await fetch("".concat("https://app.fadiar.com/api","/eliminar-direccion-domicilio-cliente"),{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id_direccion:e})})).ok)throw Error("Error al eliminar la direcci\xf3n");i&&await F()}catch(e){console.error("Error deleting address:",e),alert("Error al eliminar la direcci\xf3n")}},W=async a=>{if(a.preventDefault(),w(""),h.length<8){w("La contrase\xf1a debe tener al menos 8 caracteres");return}if(h!==g){w("Las contrase\xf1as no coinciden");return}try{if(!e)return;let a=new FormData;a.append("name",e.name),a.append("lastname1",e.last1),a.append("lastname2",e.last2),a.append("current_password",m),a.append("new_password",h);let i=await fetch("".concat(l.env.NEXT_PUBLIC_API,"/changePassword"),{method:"POST",body:a});if(!i.ok){let e=await i.json();throw Error(e.error||"Error al cambiar contrase\xf1a")}p(""),b(""),u(!1),alert("\xa1Contrase\xf1a actualizada!")}catch(e){w(e instanceof Error?e.message:"Error")}};return e?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-[#022953] mb-8",children:"Mi Cuenta - Fadiar"}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Informaci\xf3n de usuario"}),(0,r.jsx)(n.N,{mode:"wait",children:(0,r.jsxs)(o.P.dl,{initial:"hidden",animate:"visible",exit:"exit",variants:c,className:"space-y-4",transition:{duration:.2},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Nombre completo"}),(0,r.jsxs)("dd",{className:"mt-1 text-sm text-gray-900",children:[e.name," ",e.last1," ",e.last2]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Correo electr\xf3nico"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:e.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Tel\xe9fono"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:e.phone&&parseInt(e.phone)>=0?e.phone:"No asignado"})]})]},"displayInfo")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Seguridad"}),(0,r.jsx)("div",{className:"space-y-4",children:i?(0,r.jsx)(n.N,{mode:"wait",children:(0,r.jsxs)(o.P.form,{initial:"hidden",animate:"visible",exit:"exit",variants:c,onSubmit:W,className:"space-y-4",transition:{duration:.2},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Contrase\xf1a actual"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:j?"text":"password",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#022953] pr-10",value:m,onChange:e=>x(e.target.value)}),(0,r.jsx)("button",{type:"button",onClick:()=>y(!j),className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,r.jsx)(d,{show:j})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Nueva contrase\xf1a"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:v?"text":"password",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#022953] pr-10",value:h,onChange:e=>p(e.target.value)}),(0,r.jsx)("button",{type:"button",onClick:()=>f(!v),className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,r.jsx)(d,{show:v})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Confirmar nueva contrase\xf1a"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:N?"text":"password",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#022953] pr-10",value:g,onChange:e=>b(e.target.value)}),(0,r.jsx)("button",{type:"button",onClick:()=>C(!N),className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,r.jsx)(d,{show:N})})]})]}),S&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:S}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{type:"submit",className:"bg-[#022953] text-white py-2 px-4 rounded-md hover:bg-[#011a3a] transition-colors",children:"Guardar cambios"}),(0,r.jsx)("button",{type:"button",onClick:()=>u(!1),className:"bg-gray-200 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-300 transition-colors",children:"Cancelar"})]})]},"passwordForm")}):(0,r.jsx)(n.N,{mode:"wait",children:(0,r.jsxs)(o.P.div,{initial:"hidden",animate:"visible",exit:"exit",variants:c,className:"space-y-4",transition:{duration:.2},children:[(0,r.jsx)("button",{onClick:()=>u(!0),className:"w-full text-left p-3 rounded-md bg-[#022953] text-white hover:bg-[#011a3a] transition-colors",children:"Cambiar contrase\xf1a"}),(0,r.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-blue-800",children:"Datos de seguridad"}),(0,r.jsxs)("dl",{className:"mt-2 space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-xs font-medium text-blue-700",children:"Nombre completo"}),(0,r.jsxs)("dd",{className:"text-sm text-blue-900",children:[e.name," ",e.last1," ",e.last2]})]}),e.email&&(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-xs font-medium text-blue-700",children:"Correo"}),(0,r.jsx)("dd",{className:"text-sm text-blue-900",children:e.email})]})]})]})]},"securityInfo")})})]})]}),(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-700",children:"Mis Direcciones"}),(0,r.jsx)("button",{onClick:()=>{A(!E),E&&(B(null),T({provincia:"",municipio:"",direccion:""}))},className:"bg-[#022953] text-white py-2 px-4 rounded-md hover:bg-[#011a3a] transition-colors text-sm",children:E?"Cancelar":"Agregar Direcci\xf3n"})]}),E&&(0,r.jsx)(o.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-6 overflow-hidden",children:(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,r.jsx)("h4",{className:"text-md font-medium mb-4",children:z?"Editar Direcci\xf3n":"Nueva Direcci\xf3n"}),R&&(0,r.jsx)("div",{className:"bg-red-50 text-red-600 p-3 rounded-md mb-4 text-sm",children:R}),(0,r.jsxs)("form",{onSubmit:H,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Provincia *"}),(0,r.jsxs)("select",{name:"provincia",value:J.provincia,onChange:q,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#022953] bg-white",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Seleccione una provincia"}),Object.keys(G).map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Municipio *"}),(0,r.jsxs)("select",{name:"municipio",value:J.municipio,onChange:q,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#022953] bg-white",required:!0,disabled:!J.provincia,children:[(0,r.jsx)("option",{value:"",children:"Seleccione un municipio"}),D.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Direcci\xf3n *"}),(0,r.jsx)("input",{type:"text",name:"direccion",value:J.direccion,onChange:q,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#022953]",required:!0})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 pt-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{A(!1),B(null),T({provincia:"",municipio:"",direccion:""})},className:"px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Cancelar"}),(0,r.jsxs)("button",{type:"submit",className:"px-4 py-2 text-sm text-white bg-[#022953] rounded-md hover:bg-[#011a3a]",children:[z?"Actualizar":"Agregar"," Direcci\xf3n"]})]})]})]})}),P?(0,r.jsx)("div",{className:"text-center py-8",children:"Cargando direcciones..."}):0===M.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No tienes direcciones guardadas. Agrega una para comenzar."}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:M.map(e=>(0,r.jsxs)("div",{className:"border rounded-lg p-4 relative",children:[(0,r.jsxs)("div",{className:"absolute top-2 right-2 flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>V(e),className:"p-1 text-gray-600 hover:text-[#022953]",title:"Editar",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),(0,r.jsx)("button",{onClick:()=>U(e.id),className:"p-1 text-gray-600 hover:text-red-600",title:"Eliminar",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),(0,r.jsxs)("h4",{className:"font-medium text-gray-800 mt-2",children:[String(e.provincia),", ",String(e.municipio)]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:String(e.direccion)})]},e.id))})]})]})]})}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Cargando..."})}}},e=>{var a=a=>e(e.s=a);e.O(0,[676,441,684,358],()=>a(7709)),_N_E=e.O()}]);